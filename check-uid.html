<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check Your Firebase UID</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .info-box {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .uid-display {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            word-break: break-all;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
        }
        button:hover {
            background: #2563eb;
        }
        .success {
            background: #d1fae5;
            border: 2px solid #10b981;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>üîç Find Your Firebase UID</h1>
    
    <div class="info-box">
        <h3>Why you need this:</h3>
        <p>Your Firestore rules need your exact UID to grant admin access. Let's find it!</p>
    </div>

    <button id="signInBtn">Sign in with Google</button>
    
    <div id="result" style="margin-top: 20px;"></div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <script>
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyDrNsSCG2FJ1es4BHe_URbwhuEpkA_5VyU",
            authDomain: "rovi-16b3a.firebaseapp.com",
            projectId: "rovi-16b3a"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        document.getElementById('signInBtn').addEventListener('click', async () => {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                provider.setCustomParameters({ prompt: 'select_account' });
                const result = await auth.signInWithPopup(provider);
                
                const user = result.user;
                document.getElementById('result').innerHTML = `
                    <div class="success">
                        <h3>‚úÖ Success! Here's your info:</h3>
                        <p><strong>Email:</strong> ${user.email}</p>
                    </div>
                    
                    <div class="uid-display">
                        <strong>Your UID:</strong><br>
                        ${user.uid}
                    </div>
                    
                    <div class="info-box" style="margin-top: 20px;">
                        <h3>üìù Next Step:</h3>
                        <p>1. Copy your UID above</p>
                        <p>2. Go to <a href="https://console.firebase.google.com/project/rovi-16b3a/firestore/rules" target="_blank">Firestore Rules</a></p>
                        <p>3. Update the isAdmin function to use your UID:</p>
                        <pre style="background: #1f2937; color: #f3f4f6; padding: 10px; border-radius: 4px; overflow-x: auto;">
function isAdmin() {
    return request.auth != null &&
           request.auth.uid == '${user.uid}';
}</pre>
                        <p>4. Click "Publish"</p>
                        <p>5. Your dashboard will work!</p>
                    </div>
                    
                    ${user.uid === 'byothLpU8SdS5SYpx1UFT0pGT0p1' ? 
                        '<div class="success">‚úÖ Your UID matches the one in rules! Dashboard should work.</div>' : 
                        '<div class="uid-display" style="background: #fee2e2; border-color: #ef4444;">‚ö†Ô∏è Your UID does NOT match the one in rules. You need to update the rules with your UID above.</div>'
                    }
                `;
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <div style="background: #fee2e2; border: 2px solid #ef4444; padding: 15px; border-radius: 8px;">
                        Error: ${error.message}
                    </div>
                `;
            }
        });

        // Auto-check if already signed in
        auth.onAuthStateChanged((user) => {
            if (user) {
                document.getElementById('result').innerHTML = `
                    <div class="success">
                        <h3>‚úÖ You're already signed in!</h3>
                        <p><strong>Email:</strong> ${user.email}</p>
                    </div>
                    
                    <div class="uid-display">
                        <strong>Your UID:</strong><br>
                        ${user.uid}
                    </div>
                    
                    <div class="info-box" style="margin-top: 20px;">
                        <h3>Is this the UID in your rules?</h3>
                        <p>Expected: <code>byothLpU8SdS5SYpx1UFT0pGT0p1</code></p>
                        <p>Your UID: <code>${user.uid}</code></p>
                        <p>Match: ${user.uid === 'byothLpU8SdS5SYpx1UFT0pGT0p1' ? '‚úÖ YES' : '‚ùå NO - Update rules!'}</p>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>